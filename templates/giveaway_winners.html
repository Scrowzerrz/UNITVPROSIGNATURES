<h5>Ganhadores do Sorteio #{{ giveaway.id }} - {{ giveaway.plan_name }}</h5>

{% if giveaway.winners %}
<div class="table-responsive">
    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Usuário</th>
                <th>Status</th>
                {% if giveaway.status == 'completed' %}
                <th>Confirmado em</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for winner_id in giveaway.winners %}
            <tr>
                <td>{{ winner_id }}</td>
                <td>
                    {% if winner_id in giveaway.participants %}
                        {{ giveaway.participants[winner_id].first_name }}
                        {% if giveaway.participants[winner_id].username %}
                        (@{{ giveaway.participants[winner_id].username }})
                        {% endif %}
                    {% else %}
                        Desconhecido
                    {% endif %}
                </td>
                <td>
                    {% if winner_id in giveaway.confirmation_requests %}
                        {% if giveaway.confirmation_requests[winner_id].status == 'pending' %}
                        <span class="badge bg-warning text-dark">Pendente</span>
                        {% elif giveaway.confirmation_requests[winner_id].status == 'confirmed' %}
                        <span class="badge bg-success">Confirmado</span>
                        {% elif giveaway.confirmation_requests[winner_id].status == 'expired' %}
                        <span class="badge bg-danger">Expirado</span>
                        {% endif %}
                    {% else %}
                        <span class="badge bg-secondary">Desconhecido</span>
                    {% endif %}
                </td>
                {% if giveaway.status == 'completed' %}
                <td>
                    {% if winner_id in giveaway.confirmation_requests and giveaway.confirmation_requests[winner_id].status == 'confirmed' %}
                        {{ giveaway.confirmation_requests[winner_id].confirmed_at|formatdate }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if giveaway.status == 'winners_selected' %}
<div class="alert alert-info">
    <i class="fas fa-info-circle me-2"></i> Os ganhadores têm 10 minutos para confirmar a vitória. Após esse período, novos ganhadores serão sorteados automaticamente.
</div>
{% endif %}

{% else %}
<div class="alert alert-warning">
    <i class="fas fa-exclamation-triangle me-2"></i> Nenhum ganhador foi selecionado para este sorteio.
</div>
{% endif %}

{% if giveaway.status == 'pending_draw' %}
<div class="mt-3">
    <a href="{{ url_for('draw_giveaway_winners_route') }}?giveaway_id={{ giveaway.id }}" class="btn btn-primary">
        <i class="fas fa-trophy me-1"></i> Realizar Sorteio Agora
    </a>
</div>
{% endif %}